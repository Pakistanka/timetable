!function(e,t){"function"==typeof define&&define.amd?define(["exports"],t):t("undefined"!=typeof exports?exports:e.syncscroll={})}(this,function(e){function t(){var e,t,n,o,r,i=document.getElementsByClassName("syncscroll");for(r in v)if(v.hasOwnProperty(r))for(e=0;e<v[r].length;e++)v[r][e].removeEventListener("scroll",v[r][e].syn,0);for(e=0;e<i.length;e++)if(o=0,r=(n=i[e]).getAttribute("name")){for(n=n.scroller||n,v[r]||(v[r]=[]),t=0;t<v[r].length;t++)v[r][t]==n&&(o=1);o||v[r].push(n),n.eX=n.eY=0,function(c,d){c.addEventListener("scroll",c.syn=function(){var e,t,n=v[d],o=c[f+p],r=c[f+"Top"],i=o/(c[f+u]-c[m+u]),a=r/(c[f+h]-c[m+h]),s=0,l=0;for(o!=c.eX&&(s=1,c.eX=o),r!=c.eY&&(l=1,c.eY=r),t=0;t<n.length;t++)(e=n[t])!=c&&(s&&(o=Math.round(i*(e[f+u]-e[m+u])),e.eX=e[f+p]=o),l&&(r=Math.round(a*(e[f+h]-e[m+h])),e.eY=e[f+"Top"]=r))},0)}(n,r)}}var u="Width",h="Height",p="Left",f="scroll",m="client",v=[];"complete"==document.readyState?t():window.addEventListener("load",t,0),e.reset=t});var Timetable=function(){this.scope={hourStart:9,hourEnd:17},this.usingTwelveHour=!1,this.locations=[],this.events=[]};Timetable.Renderer=function(e){if(!(e instanceof Timetable))throw new Error("Initialize renderer using a Timetable");this.timetable=e},function(){function o(e){return(n=e)===parseInt(n,10)&&(0<=(t=e)&&t<24);var t,n}function l(e,t){return-1!==t.indexOf(e)}function p(e,t){return e<=t?t-e:24+t-e}Timetable.prototype={setScope:function(e,t){if(n=t,!o(e)||!o(n))throw new RangeError("Timetable scope should consist of (start, end) in whole hours from 0 to 23");var n;return this.scope.hourStart=e,this.scope.hourEnd=t,this},useTwelveHour:function(){this.usingTwelveHour=!0},addLocations:function(e){var t=this.locations;if(!(e instanceof Array))throw new Error("Tried to add locations in wrong format");return e.forEach(function(e){if(l(e,t))throw new Error("Location already exists");t.push(e)}),this},addEvent:function(e,t,n,o,r){if(!l(t,this.locations))throw new Error("Unknown location");if(a=o,!((i=n)instanceof Date&&a instanceof Date&&i<a))throw new Error("Invalid time range: "+JSON.stringify([n,o]));var i,a,s="[object Object]"===Object.prototype.toString.call(r);return this.events.push({name:e,location:t,startDate:n,endDate:o,options:s?r:void 0}),this}},Timetable.Renderer.prototype={draw:function(e){var t,n,o,u=this.timetable,h=p(u.scope.hourStart,u.scope.hourEnd),r=document.querySelector(e);(function(e){if(null===e)throw new Error("Timetable container not found")})(r),function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(r),function(e){for(var t=0;t<u.locations.length;t++){var n=e.appendChild(document.createElement("li")).appendChild(document.createElement("span"));n.className="row-heading",n.textContent=u.locations[t]}}(r.appendChild(document.createElement("aside")).appendChild(document.createElement("ul"))),t=r.appendChild(document.createElement("section")),n=function(e){var t=e.appendChild(document.createElement("header"));t.className="syncscroll",t.setAttribute("name","scrollheader");for(var n=t.appendChild(document.createElement("ul")),o=!1,r=!1,i=u.scope.hourStart;!o;){var a=n.appendChild(document.createElement("li")).appendChild(document.createElement("span"));a.className="time-label",a.textContent=function(e,t){return t?(e+11)%12+1+":00"+(12<=e?"PM":"AM"):(e<10?"0":"")+e+":00"}(i,u.usingTwelveHour),i!==u.scope.hourEnd||u.scope.hourStart===u.scope.hourEnd&&!r||(o=!0),24==++i&&(r=!(i=0))}return t}(t),(o=t.appendChild(document.createElement("time"))).className="syncscroll",o.setAttribute("name","scrollheader"),function(e,t){var n=e.appendChild(document.createElement("ul"));n.style.width=t,n.className="room-timeline";for(var o=0;o<u.locations.length;o++){var r=n.appendChild(document.createElement("li"));!function(e,t){for(var n=0;n<u.events.length;n++){var o=u.events[n];o.location===e&&function(t,e){var n,o,r,i=void 0!==t.options,a=!1;i&&(n=void 0!==t.options.url,o=void 0!==t.options.class,r=void 0!==t.options.data,a=void 0!==t.options.onClick);var s=n?"a":"span",l=e.appendChild(document.createElement(s)),c=l.appendChild(document.createElement("small"));if(l.title=t.name,n&&(l.href=t.options.url),r)for(var d in t.options.data)l.setAttribute("data-"+d,t.options.data[d]);a&&l.addEventListener("click",function(e){t.options.onClick(t,u,e)}),l.className=o?"time-entry "+t.options.class:"time-entry",l.style.width=function(e){var t=e.startDate,n=e.endDate;return function(e,t){return(t.getTime()-e.getTime())/1e3/60/60}(t,n)/h*100+"%"}(t),l.style.left=function(e){var t=u.scope.hourStart,n=e.startDate.getHours()+e.startDate.getMinutes()/60;return p(t,n)/h*100+"%"}(t),c.textContent=t.name}(o,t)}}(u.locations[o],r)}}(o,n.scrollWidth+"px"),syncscroll.reset()}}}();